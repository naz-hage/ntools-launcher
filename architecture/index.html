
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content=".NET library for secure process launching, file downloading, and shell operations" name="description"/>
<meta content="naz-hage" name="author"/>
<link href="../usage/" rel="prev"/>
<link href="../devguide/dependencies/" rel="next"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.31" name="generator"/>
<title>System Architecture - NTools Launcher</title>
<link href="../assets/stylesheets/main.3cba04c6.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ntools-launcher-architecture">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="NTools Launcher" class="md-header__button md-logo" data-md-component="logo" href=".." title="NTools Launcher">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            NTools Launcher
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              System Architecture
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/naz-hage/ntools-launcher" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    ntools-launcher
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
          
  
  Getting Started

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="./">
          
  
  Architecture

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../devguide/dependencies/">
          
  
  Development Guide

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../revisions/changelog/">
          
  
  Revisions

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="NTools Launcher" class="md-nav__button md-logo" data-md-component="logo" href=".." title="NTools Launcher">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    NTools Launcher
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/naz-hage/ntools-launcher" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    ntools-launcher
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Getting Started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../installation/">
<span class="md-ellipsis">
    Installation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../usage/">
<span class="md-ellipsis">
    Usage
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Architecture
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    System Architecture
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    System Architecture
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture-diagram">
<span class="md-ellipsis">
      Architecture Diagram
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#core-components">
<span class="md-ellipsis">
      Core Components
    </span>
</a>
<nav aria-label="Core Components" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#launcher-class">
<span class="md-ellipsis">
      Launcher Class
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nfile-class">
<span class="md-ellipsis">
      NFile Class
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shellutility-class">
<span class="md-ellipsis">
      ShellUtility Class
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#currentprocess-class">
<span class="md-ellipsis">
      CurrentProcess Class
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#security-components">
<span class="md-ellipsis">
      Security Components
    </span>
</a>
<nav aria-label="Security Components" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#signatureverifier-class">
<span class="md-ellipsis">
      SignatureVerifier Class
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#virustotalchecker-class">
<span class="md-ellipsis">
      VirusTotalChecker Class
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#result-classes">
<span class="md-ellipsis">
      Result Classes
    </span>
</a>
<nav aria-label="Result Classes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#resulthelper-class">
<span class="md-ellipsis">
      ResultHelper Class
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#resultdownload-class">
<span class="md-ellipsis">
      ResultDownload Class
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#file-structure">
<span class="md-ellipsis">
      File Structure
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
<span class="md-ellipsis">
      Dependencies
    </span>
</a>
<nav aria-label="Dependencies" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#runtime-dependencies">
<span class="md-ellipsis">
      Runtime Dependencies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#development-dependencies">
<span class="md-ellipsis">
      Development Dependencies
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#security-considerations">
<span class="md-ellipsis">
      Security Considerations
    </span>
</a>
<nav aria-label="Security Considerations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#digital-signature-verification">
<span class="md-ellipsis">
      Digital Signature Verification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#file-download-security">
<span class="md-ellipsis">
      File Download Security
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#process-elevation">
<span class="md-ellipsis">
      Process Elevation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing-strategy">
<span class="md-ellipsis">
      Testing Strategy
    </span>
</a>
<nav aria-label="Testing Strategy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#unit-tests">
<span class="md-ellipsis">
      Unit Tests
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-tests">
<span class="md-ellipsis">
      Integration Tests
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#security-testing">
<span class="md-ellipsis">
      Security Testing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#build-and-deployment">
<span class="md-ellipsis">
      Build and Deployment
    </span>
</a>
<nav aria-label="Build and Deployment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#build-process">
<span class="md-ellipsis">
      Build Process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#distribution">
<span class="md-ellipsis">
      Distribution
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#future-enhancements">
<span class="md-ellipsis">
      Future Enhancements
    </span>
</a>
<nav aria-label="Future Enhancements" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#platform-support">
<span class="md-ellipsis">
      Platform Support
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#feature-additions">
<span class="md-ellipsis">
      Feature Additions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-optimizations">
<span class="md-ellipsis">
      Performance Optimizations
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Development Guide
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Development Guide
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../devguide/dependencies/">
<span class="md-ellipsis">
    Project Dependencies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../devguide/setup/">
<span class="md-ellipsis">
    Environment Setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../devguide/build-and-test/">
<span class="md-ellipsis">
    Build and Test
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../devguide/targets/">
<span class="md-ellipsis">
    Build Targets
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Revisions
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Revisions
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../revisions/changelog/">
<span class="md-ellipsis">
    Changelog
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="ntools-launcher-architecture">NTools Launcher Architecture<a class="headerlink" href="#ntools-launcher-architecture" title="Anchor link to this section for reference">¶</a></h1>
<p>This document provides a comprehensive overview of the NTools Launcher architecture, a .NET library that simplifies common tasks related to launching executables, downloading files, executing shell commands, and checking process elevation.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Anchor link to this section for reference">¶</a></h2>
<p>NTools Launcher is a NuGet package library written in .NET that provides robust functionality for:</p>
<ul>
<li><strong>Process Launching</strong>: Launch executables with digital signature verification</li>
<li><strong>File Downloading</strong>: Secure file downloads with integrity checks</li>
<li><strong>Shell Command Execution</strong>: Execute shell commands and retrieve results</li>
<li><strong>Process Elevation Checking</strong>: Determine if the current process is elevated</li>
<li><strong>Security Features</strong>: Digital signature verification, VirusTotal integration</li>
</ul>
<h2 id="architecture-diagram">Architecture Diagram<a class="headerlink" href="#architecture-diagram" title="Anchor link to this section for reference">¶</a></h2>
<pre class="mermaid"><code>graph TB
    subgraph "NTools Launcher Library"
        subgraph "Core Classes"
            L[Launcher&lt;br/&gt;Process launching&lt;br/&gt;with security checks]
            NF[NFile&lt;br/&gt;Secure file downloading&lt;br/&gt;with integrity checks]
            SU[ShellUtility&lt;br/&gt;Shell command execution&lt;br/&gt;Path resolution]
            CP[CurrentProcess&lt;br/&gt;Process elevation&lt;br/&gt;checking]
        end

        subgraph "Result Classes"
            RH[ResultHelper&lt;br/&gt;Process execution results&lt;br/&gt;Output handling]
            RD[ResultDownload&lt;br/&gt;Download operation results&lt;br/&gt;File validation results]
        end

        subgraph "Security Components"
            SV[SignatureVerifier&lt;br/&gt;Digital signature&lt;br/&gt;verification]
            VT[VirusTotalChecker&lt;br/&gt;Virus scanning&lt;br/&gt;integration]
        end
    end

    subgraph "External Dependencies"
        SC[System.Security.Cryptography&lt;br/&gt;Cryptographic operations]
        SP[System.Security.Principal&lt;br/&gt;Process elevation checks]
        SJ[System.Text.Json&lt;br/&gt;JSON processing]
        NP[System.Net&lt;br/&gt;HTTP operations]
        IO[System.IO&lt;br/&gt;File system operations]
    end

    L --&gt; SV
    L --&gt; RH
    NF --&gt; VT
    NF --&gt; RD
    NF --&gt; SV
    SU --&gt; RH

    L --&gt; SC
    NF --&gt; SC
    SV --&gt; SC
    VT --&gt; SJ
    NF --&gt; NP
    L --&gt; IO
    CP --&gt; SP

    style L fill:#e1f5fe
    style NF fill:#f3e5f5
    style SU fill:#e8f5e8
    style CP fill:#fff3e0
    style RH fill:#fce4ec
    style RD fill:#f1f8e9
    style SV fill:#e0f2f1
    style VT fill:#f9fbe7</code></pre>
<h2 id="core-components">Core Components<a class="headerlink" href="#core-components" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="launcher-class">Launcher Class<a class="headerlink" href="#launcher-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Main class for launching processes with security features</li>
<li><strong>Key Features</strong>:</li>
<li>Process launching with optional digital signature verification</li>
<li>File locking during execution</li>
<li>Asynchronous process launching</li>
<li>Thread-safe operations</li>
<li><strong>Methods</strong>:</li>
<li><code>LaunchAsync()</code> - Launch process asynchronously</li>
<li><code>LaunchAndWait()</code> - Launch and wait for completion</li>
<li><code>LockAndLaunch()</code> - Lock file and launch with verification</li>
</ul>
<h3 id="nfile-class">NFile Class<a class="headerlink" href="#nfile-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Secure file downloading with integrity and security checks</li>
<li><strong>Key Features</strong>:</li>
<li>HTTP/HTTPS file downloads</li>
<li>Digital signature verification</li>
<li>File size validation</li>
<li>VirusTotal integration</li>
<li>Progress reporting</li>
<li><strong>Methods</strong>:</li>
<li><code>DownloadAsync()</code> - Download file with all security checks</li>
<li><code>ValidateSignature()</code> - Verify digital signatures</li>
<li><code>CheckVirusTotal()</code> - Scan with VirusTotal</li>
</ul>
<h3 id="shellutility-class">ShellUtility Class<a class="headerlink" href="#shellutility-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Execute shell commands and resolve file paths</li>
<li><strong>Key Features</strong>:</li>
<li>Command execution with output capture</li>
<li>Path environment variable resolution</li>
<li>Error handling and result reporting</li>
<li><strong>Methods</strong>:</li>
<li><code>ExecuteCommand()</code> - Execute shell commands</li>
<li><code>GetFullPath()</code> - Resolve full file paths from PATH</li>
</ul>
<h3 id="currentprocess-class">CurrentProcess Class<a class="headerlink" href="#currentprocess-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Check process elevation status</li>
<li><strong>Key Features</strong>:</li>
<li>Windows administrator privilege detection</li>
<li>Cross-platform compatibility considerations</li>
<li><strong>Methods</strong>:</li>
<li><code>IsElevated()</code> - Check if current process is elevated</li>
</ul>
<h2 id="security-components">Security Components<a class="headerlink" href="#security-components" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="signatureverifier-class">SignatureVerifier Class<a class="headerlink" href="#signatureverifier-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Digital signature verification for executables and files</li>
<li><strong>Key Features</strong>:</li>
<li>Authenticode signature validation</li>
<li>Certificate chain verification</li>
<li>Timestamp validation</li>
<li><strong>Dependencies</strong>: System.Security.Cryptography.Pkcs</li>
</ul>
<h3 id="virustotalchecker-class">VirusTotalChecker Class<a class="headerlink" href="#virustotalchecker-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Virus scanning integration with VirusTotal API</li>
<li><strong>Key Features</strong>:</li>
<li>API key authentication</li>
<li>File hash submission and scanning</li>
<li>Result parsing and reporting</li>
<li><strong>Dependencies</strong>: System.Net, System.Text.Json</li>
</ul>
<h2 id="result-classes">Result Classes<a class="headerlink" href="#result-classes" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="resulthelper-class">ResultHelper Class<a class="headerlink" href="#resulthelper-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Handle results from process execution operations</li>
<li><strong>Properties</strong>:</li>
<li><code>Code</code> - Exit code from executed process</li>
<li><code>Output</code> - List of output lines</li>
<li><code>Success</code> - Boolean success indicator</li>
<li><strong>Methods</strong>:</li>
<li><code>GetFirstOutput()</code> - Get first line of output</li>
<li><code>HasOutput()</code> - Check if output exists</li>
</ul>
<h3 id="resultdownload-class">ResultDownload Class<a class="headerlink" href="#resultdownload-class" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>Purpose</strong>: Handle results from file download operations</li>
<li><strong>Properties</strong>:</li>
<li><code>FileSize</code> - Size of downloaded file</li>
<li><code>X509Certificate2</code> - Certificate if verified</li>
<li><code>Code</code> - Result code</li>
<li><code>Output</code> - Operation output</li>
<li><strong>Methods</strong>:</li>
<li><code>IsSuccess()</code> - Check if download succeeded</li>
<li><code>DisplayCertificate()</code> - Show certificate information</li>
</ul>
<h2 id="file-structure">File Structure<a class="headerlink" href="#file-structure" title="Anchor link to this section for reference">¶</a></h2>
<div class="highlight"><pre><span></span><code>ntools-launcher/
├── ntools-launcher.sln           # Main solution file
├── Nbuild.bat                    # Build script
├── mkdocs.yml                    # Documentation configuration
├── README.md                     # Project documentation
├── targets.md                    # Build targets documentation
├── coverage.cobertura.xml        # Test coverage report
├── nbuild.targets                # MSBuild targets
├── unit-tests.targets            # Unit test targets
├── e2e-tests.targets             # E2E test targets
│
├── launcher/                     # Main library project
│   ├── Launcher.csproj
│   ├── Launcher.cs               # Main Launcher class
│   ├── NFile.cs                  # File download functionality
│   ├── ShellUtility.cs           # Shell command execution
│   ├── CurrentProcess.cs         # Process elevation checking
│   ├── ResultHelper.cs           # Process result handling
│   ├── ResultDownload.cs         # Download result handling
│   ├── SignatureVerifier.cs      # Digital signature verification
│   └── VirusTotalChecker.cs      # VirusTotal integration
│
├── LauncherTest/                 # Test project
│   ├── LauncherTest.csproj
│   └── LauncherTest.cs           # Basic tests
│
├── LauncherTests/                # Comprehensive test suite
│   ├── LauncherTests.csproj
│   ├── LauncherTests.cs          # Launcher class tests
│   ├── NFileTests.cs             # NFile class tests
│   ├── ResultDownloadTests.cs    # ResultDownload tests
│   ├── ResultHelperTests.cs      # ResultHelper tests
│   ├── ShellUtilityTests.cs      # ShellUtility tests
│   ├── SignatureVerifierTests.cs # SignatureVerifier tests
│   └── VirusTotalCheckerTests.cs # VirusTotalChecker tests
│
├── docs/                         # Documentation
│   ├── index.md
│   ├── installation.md
│   ├── usage.md
│   ├── devguide/
│   │   ├── setup.md
│   │   ├── dependencies.md
│   │   ├── build-and-test.md
│   │   └── targets.md
│   └── revisions/
│
└── .github/                      # GitHub configuration
    ├── workflows/
    │   └── dotnet-desktop.yml    # CI/CD pipeline
    └── validation/               # Configuration validation
</code></pre></div>
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="runtime-dependencies">Runtime Dependencies<a class="headerlink" href="#runtime-dependencies" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>.NET 10.0</strong>: Target framework for execution</li>
<li><strong>Windows OS</strong>: Primary platform support</li>
<li><strong>Internet Access</strong>: Required for VirusTotal API and file downloads</li>
</ul>
<h3 id="development-dependencies">Development Dependencies<a class="headerlink" href="#development-dependencies" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>MSTest v4.0.2</strong>: Testing framework</li>
<li><strong>Microsoft.NET.Test.Sdk v18.0.1</strong>: Test SDK</li>
<li><strong>System.Security.Cryptography.Pkcs v10.0.1</strong>: Cryptographic operations</li>
<li><strong>System.Text.Json v10.0.1</strong>: JSON processing</li>
<li><strong>System.Security.Principal.Windows v5.0.0</strong>: Process elevation checks</li>
</ul>
<h2 id="security-considerations">Security Considerations<a class="headerlink" href="#security-considerations" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="digital-signature-verification">Digital Signature Verification<a class="headerlink" href="#digital-signature-verification" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>All executable launches can optionally verify Authenticode signatures</li>
<li>Certificate chain validation ensures trust hierarchy</li>
<li>Timestamp validation prevents replay attacks</li>
</ul>
<h3 id="file-download-security">File Download Security<a class="headerlink" href="#file-download-security" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>HTTPS-only downloads (configurable)</li>
<li>File hash verification against known good values</li>
<li>VirusTotal integration for malware detection</li>
<li>File size validation to prevent resource exhaustion</li>
</ul>
<h3 id="process-elevation">Process Elevation<a class="headerlink" href="#process-elevation" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>Secure checking of administrator privileges</li>
<li>No elevation escalation - only detection</li>
<li>Cross-platform considerations for future expansion</li>
</ul>
<h2 id="testing-strategy">Testing Strategy<a class="headerlink" href="#testing-strategy" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="unit-tests">Unit Tests<a class="headerlink" href="#unit-tests" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>Comprehensive test coverage for all public methods</li>
<li>Mock external dependencies (VirusTotal API, file system)</li>
<li>Test both success and failure scenarios</li>
<li>Parallel test execution with <code>[DoNotParallelize]</code> where needed</li>
</ul>
<h3 id="integration-tests">Integration Tests<a class="headerlink" href="#integration-tests" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>End-to-end process launching scenarios</li>
<li>Real file download testing (with safe URLs)</li>
<li>Shell command execution validation</li>
</ul>
<h3 id="security-testing">Security Testing<a class="headerlink" href="#security-testing" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>Digital signature validation testing</li>
<li>Certificate chain testing</li>
<li>VirusTotal API integration testing</li>
</ul>
<h2 id="build-and-deployment">Build and Deployment<a class="headerlink" href="#build-and-deployment" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="build-process">Build Process<a class="headerlink" href="#build-process" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>MSBuild-based compilation using nbuild system</li>
<li>Multi-target framework support (.NET 10.0)</li>
<li>NuGet package generation for distribution</li>
<li>Test execution with coverage reporting</li>
</ul>
<h3 id="distribution">Distribution<a class="headerlink" href="#distribution" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li><strong>NuGet Package</strong>: <code>ntools-launcher</code> on nuget.org</li>
<li><strong>GitHub Releases</strong>: Source code and documentation</li>
<li><strong>Documentation Site</strong>: MkDocs-generated static site</li>
</ul>
<h2 id="future-enhancements">Future Enhancements<a class="headerlink" href="#future-enhancements" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="platform-support">Platform Support<a class="headerlink" href="#platform-support" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>Linux and macOS support expansion</li>
<li>Cross-platform process launching</li>
<li>Platform-specific security features</li>
</ul>
<h3 id="feature-additions">Feature Additions<a class="headerlink" href="#feature-additions" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>Additional antivirus integrations</li>
<li>Advanced process monitoring</li>
<li>Download resume capabilities</li>
<li>Batch operation support</li>
</ul>
<h3 id="performance-optimizations">Performance Optimizations<a class="headerlink" href="#performance-optimizations" title="Anchor link to this section for reference">¶</a></h3>
<ul>
<li>Async operation improvements</li>
<li>Memory usage optimization</li>
<li>Concurrent download support
<parameter name="filePath">c:\source\ntools-launcher\docs\architecture.md</parameter></li>
</ul>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
</body>
</html>